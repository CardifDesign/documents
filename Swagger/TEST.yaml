swagger: "2.0"
info:
  title: COL_PaymentGateway  - Tibco service
  version: 1.0.4
  description: "<hr/> Payment Gateway - Tibco service <br/> For ESB-Tibco systems <br/> Low Risk test.
    <br/>Used Packages:
    <br/>Schema = xx, PackageDataBase = xx, NameOperation = xxx
    <hr/> Controles de cambio. <br/>
    16/09/2020 - Creación.
    08/10/2020 - Se habilita el metodo /payu/token <br/>
    15/10/2020 - Se incluye el metodo /payu/refund para las devoluciones
    27/10/2020 - Se ajusta metodo /payu/tokenization-payment, se agrega tags Partner y Event.
    "
  license:
    name: BNP Paribas Cardif Colombia - Seguros Generales S.A
    url: "https://bnpparibascardif.com.co/"
host: vip-busintco-test.co.xcd.net.intra:20310
basePath: /payment-gateway/v1
tags:
  - name: Default
  - name: Payment PayU
schemes:
  - https
paths:
  /payu/ping-payments:
    get:
      tags:
        - Default
      summary: Server heartbeat operation
      description: "This operation shows how to override the global security defined above, as we want to open it up for all users."
      security: []
      responses:
        "200":
          description: OK
        "400":
          description: Invalid Request.

  /payu/tokenization-payment:
    post:
      tags:
        - Payment PayU
      summary: Perform tokenization and payment
      consumes:
        - application/json
      parameters:
        - in: body
          name: direct-token
          schema:
            $ref: "#/definitions/paymentGateway"
      responses:
        default:
          description: "('200','Success'); (También sirve para un update) ('201','Created Success');  ('204','No Content');(Este aplica cuando llegas a la BD y no obtienes información) ('400','Technical Error'); ('404','Not Found');(método no encontrado) ('408','ConnectionTimeout'); ('422','Unprocessable Entity');(Error por null DB) ('430','Database Exception');(Cualquier otro error en DB)."
          schema:
            $ref: "#/definitions/paymentGatewayResponse"

  /payu/payment:
    post:
      tags:
        - Payment PayU
      summary: Perform payment
      consumes:
        - application/json
      parameters:
        - in: body
          name: direct
          schema:
            $ref: "#/definitions/paymentGateway"
      responses:
        default:
          description: "('200','Success'); (También sirve para un update) ('201','Created Success');  ('204','No Content');(Este aplica cuando llegas a la BD y no obtienes información) ('400','Technical Error'); ('404','Not Found');(método no encontrado) ('408','ConnectionTimeout'); ('422','Unprocessable Entity');(Error por null DB) ('430','Database Exception');(Cualquier otro error en DB)."
          schema:
            $ref: "#/definitions/paymentGatewayResponse"
      deprecated: true

  /payu/tokenization:
    post:
      tags:
        - Payment PayU
      summary: Perform tokenization
      consumes:
        - application/json
      parameters:
        - in: body
          name: emissionRequestData
          schema:
            $ref: "#/definitions/paymentGateway"
      responses:
        default:
          description: "('200','Success'); (También sirve para un update) ('201','Created Success');  ('204','No Content');(Este aplica cuando llegas a la BD y no obtienes información) ('400','Technical Error'); ('404','Not Found');(método no encontrado) ('408','ConnectionTimeout'); ('422','Unprocessable Entity');(Error por null DB) ('430','Database Exception');(Cualquier otro error en DB)."
          schema:
            $ref: "#/definitions/paymentGatewayResponse"
      deprecated: true

  /payu/token:
    post:
      tags:
        - Payment PayU
      summary: Perform token payment
      consumes:
        - application/json
      parameters:
        - in: body
          name: emissionRequestData
          schema:
            $ref: "#/definitions/paymentGatewayToken"
      responses:
        default:
          description: "('200','Success'); (También sirve para un update) ('201','Created Success');  ('204','No Content');(Este aplica cuando llegas a la BD y no obtienes información) ('400','Technical Error'); ('404','Not Found');(método no encontrado) ('408','ConnectionTimeout'); ('422','Unprocessable Entity');(Error por null DB) ('430','Database Exception');(Cualquier otro error en DB)."
          schema:
            $ref: "#/definitions/paymentGatewayResponseToken"


  /payu/refund:
    post:
      tags:
        - Payment PayU
      summary: Perform a Refund
      consumes:
        - application/json
      parameters:
        - in: body
          name: emissionRequestData
          schema:
            $ref: "#/definitions/paymentGatewayRefund"
      responses:
        default:
          description: "('200','Success'); (También sirve para un update) ('201','Created Success');  ('204','No Content');(Este aplica cuando llegas a la BD y no obtienes información) ('400','Technical Error'); ('404','Not Found');(método no encontrado) ('408','ConnectionTimeout'); ('422','Unprocessable Entity');(Error por null DB) ('430','Database Exception');(Cualquier otro error en DB)."
          schema:
            $ref: "#/definitions/paymentGatewayResponse"



definitions:

#---------------------------------------------
  paymentGatewayResponse:
    type: object
    properties:
      returnCode:
        type: integer
        description: Response Return Code
      mesagge:
        type: string
        description: Response Description
      bodyResponse:
        type: object
        properties:
          person:
            type: object
            properties:
              state:
                type: string
                description: transaction status

#---------------------------------------------
  paymentGateway:
    type: object
    properties:
      language:
        type: string
        maxLength: 2
        description: The language used in the petition. Using for system error messages. See supported languages
      command:
        type: string
        maxLength: 32
        description: Use SUBMIT_TRANSACTION.
      merchant:
        $ref: "#/definitions/merchant"
      transaction:
        $ref: "#/definitions/transactionPayment"
      test:
        type: boolean
        description: Use SUBMIT_TRANSACTION.
      partner:
        $ref: "#/definitions/partner"
      event:
        $ref: "#/definitions/event"
      person:
        $ref: "#/definitions/person"


#---------------------------------------------
  paymentGatewayToken:
    type: object
    properties:
      language:
        type: string
        maxLength: 2
        description: The language used in the petition. Using for system error messages. See supported languages
      command:
        type: string
        maxLength: 32
        description: Use SUBMIT_TRANSACTION.
      merchant:
        $ref: "#/definitions/merchant"
      transaction:
        $ref: "#/definitions/transactionToken"
      test:
        type: boolean
        description: Use SUBMIT_TRANSACTION.

#---------------------------------------------
  paymentGatewayRefund:
    properties:
      language:
        type: string
        maxLength: 2
        description: The language used in the petition. Using for system error messages. See supported languages
      command:
        type: string
        maxLength: 32
        description: Use SUBMIT_TRANSACTION.
      merchant:
        $ref: "#/definitions/merchant"
      transaction:
        $ref: "#/definitions/transactionRefund"
      test:
        type: boolean
        description: Use SUBMIT_TRANSACTION.

#---------------------------------------------
  merchant:
    type: object
    required:
      - apiKey
      - apiLogin
      - type
      - paymentMethod
      - paymentCountry
      - deviceSessionId
      - ipAddress
      - cookie
      - userAgent
    properties:
      apiKey:
        type: string
        minLength: 6
        maxLength: 32
        description: The user or login provided by PayU.
      apiLogin:
        type: string
        minLength: 12
        maxLength: 32
        description: The key or password provided by PayU.

#---------------------------------------------
  transactionPayment:
    type: object
    properties:
      order:
         $ref: "#/definitions/order"
      shippingAddress:
        $ref: "#/definitions/shippingAddress"
      payer:
        $ref: "#/definitions/payer"
      creditCard:
        $ref: "#/definitions/creditCard"
      extraParameters:
        $ref: "#/definitions/extraParameters2"
      type:
        type: string
        maxLength: 32
        description: For authorization and capture= AUTHORIZATION_AND_CAPTURE For authorization= AUTHORIZATION
      paymentMethod:
        type: string
        maxLength: 32
        description: The means of payment.
      paymentCountry:
        type: string
        maxLength: 2
        description: Country of payment.
      deviceSessionId:
        type: string
        maxLength: 255
        description: The identifier of the session of the device from where the transaction is made. You can find more information on the page
      ipAddress:
        type: string
        maxLength: 39
        description: The IP address of the device from where the transaction is made.
      cookie:
        type: string
        maxLength: 255
        description: The cookie stored on the device from where the transaction is made.
      userAgent:
        type: string
        maxLength: 1024
        description: The user agent of the browser from where the transaction is made.

#---------------------------------------------
  transactionToken:
    type: object
    properties:
      order:
         $ref: "#/definitions/order"
      payer:
        $ref: "#/definitions/payer"
      creditCardTokenId:
        type: string
        description: credit card token
      creditCard:
        $ref: "#/definitions/creditCardToken"
      extraParameters:
        $ref: "#/definitions/extraParameters"

#---------------------------------------------
  transactionRefund:
    type: object
    properties:
      order:
        type: object
        properties:
          Id:
            type: number
            description: Id number provided by PayU
      type:
        type: string
        maxLength: 32
        description: REFUND
      reason:
        type: string
        description: Reason for requesting the refund or cancellation of the transaction
      parentTransactionId:
        type: string
        description: Parent transaction Id.

#---------------------------------------------
  order:
    type: object
    required:
    - accountId
    - referenceCode
    - description
    - language
    - signature
    properties:
      accountId:
        type: number
        description: The key or password provided by PayU.
      referenceCode:
        type: string
        minLength: 1
        maxLength: 255
        description: The order reference code. Represents the identifier of the transaction in the merchant's system.
      description:
        type: string
        minLength: 1
        maxLength: 255
        description: The description of the order
      language:
        type: string
        maxLength: 2
        description: The language used in the emails sent by the buyer and seller.
      signature:
        type: string
        maxLength: 255
        description: TheThe signature associated with the order. To learn more visit
      notifyUrl:
        type: string
        maxLength: 2048
        description: The notification or confirmation URL of the order.
      additionalValues:
        type: object
        properties:
          TX_VALUE:
            type: object
            required:
              - value
              - currency
            properties:
              value:
                type: number
                maxLength: 64
                description: TX_VALUE, is the total amount of the transaction. It can contain two decimal digit. Eg 10000.00 or 10000. This value must be sent in transaction.order.additionalValues.entry.additionalValue.value
              currency:
                type: string
                maxLength: 3
                description: The ISO code of the currency associated with the amount.
          TX_TAX:
            type: object
            required:
              - value
              - currency
            properties:
              value:
                type: number
                maxLength: 64
                description: TX_TAX, is the VAT value (Value Added Tax only valid for Colombia) of the transaction, if the null VAT is sent, the system will automatically apply 19. It can contain two decimal digits. Ex= 19000.00.
              currency:
                type: string
                maxLength: 3
                description: The ISO code of the currency associated with the amount.
          TX_TAX_RETURN_BASE:
            type: object
            required:
              - value
              - currency
            properties:
              value:
                type: number
                maxLength: 64
                description: TX_TAX_RETURN_BASE, It is the base value on which the VAT is calculated only valid for Colombia. In case it does not have VAT, it must be sent in 0
              currency:
                type: string
                maxLength: 3
                description: The ISO code of the currency associated with the amount.
      buyer:
        $ref: "#/definitions/buyer"

#---------------------------------------------
  buyer:
    type: object
    required:
      - fullName
      - emailAddress
      - contactPhone
      - dniNumber
    properties:
        merchantBuyerId:
          type: string
          maxLength: 100
          description: Buyer identifier in the merchant's system.
        fullName:
          type: string
          maxLength: 150
          description: Full names of the buyer.
        emailAddress:
          type: string
          maxLength: 255
          description: Buyer's email.
        contactPhone:
          type: string
          maxLength: 20
          description: Buyer's contact telephone number.
        dniNumber:
          type: string
          maxLength: 20
          description: Buyer identification number.
        shippingAddress:
          $ref: "#/definitions/shippingAddress"

#---------------------------------------------
  shippingAddress:
    type: object
    properties:
              street1:
                type: string
                maxLength: 100
                description: First line of the address.
              street2:
                type: string
                maxLength: 100
                description: Second line of the address.
              city:
                type: string
                maxLength: 50
                description: Address city.
              state:
                type: string
                maxLength: 50
                description: State.
              country:
                type: string
                maxLength: 2
                description: country.
              postalCode:
                type: string
                maxLength: 20
                description: Buyer's shipping address zip code.
              phone:
                type: string
                maxLength: 20
                description: Buyer's shipping address zip code.

#---------------------------------------------
  payer:
    type: object
    required:
      - fullName
      - emailAddress
      - contactPhone
      - dniNumber
    properties:
        merchantBuyerId:
          type: string
          maxLength: 100
          description: Buyer identifier in the merchant's system.
        fullName:
          type: string
          maxLength: 150
          description: Full names of the buyer.
        emailAddress:
          type: string
          maxLength: 255
          description: Buyer's email.
        contactPhone:
          type: string
          maxLength: 20
          description: Payer's contact telephone number.
        dniNumber:
          type: string
          maxLength: 20
          description: payer's document.
        shippingAddress:
          $ref: "#/definitions/shippingAddress"

#---------------------------------------------
  creditCard:
    type: object
    required:
      - number
      - securityCode
      - contactPhone
      - expirationDate
      - name
    properties:
        number:
          type: string
          minLength: 13
          maxLength: 20
          description: The credit card number.
        securityCode:
          type: string
          minLength: 1
          maxLength: 4
          description: The credit card security code (CVC2, CVV2, CID).
        expirationDate:
          type: string
          format: YYYY/MM
          maxLength: 7
          description: The expiration date of the credit card, see in the examples the availability by means of payment. YYYY / MM format.
        name:
          type: string
          minLength: 13
          maxLength: 20
          description: The credit card number.

#---------------------------------------------
  creditCardToken:
    type: object
    required:
      - processWithoutCvv2
      - securityCode
    properties:
      processWithoutCvv2:
        type: string
      securityCode:
        type: integer
        minLength: 1
        maxLength: 3

#---------------------------------------------
  extraParameters:
    type: object
    properties:
      type:
        type: string
        maxLength: 32
        description: For authorization and capture= AUTHORIZATION_AND_CAPTURE For authorization= AUTHORIZATION
      paymentMethod:
        type: string
        maxLength: 32
        description: The means of payment.
      paymentCountry:
        type: string
        maxLength: 2
        description: Country of payment.
      deviceSessionId:
        type: string
        maxLength: 255
        description: The identifier of the session of the device from where the transaction is made. You can find more information on the page
      ipAddress:
        type: string
        maxLength: 39
        description: The IP address of the device from where the transaction is made.
      cookie:
        type: string
        maxLength: 255
        description: The cookie stored on the device from where the transaction is made.
      userAgent:
        type: string
        maxLength: 1024
        description: The user agent of the browser from where the transaction is made.

#---------------------------------------------

  extraParameters2:
    type: object
    required:
      - number
      - securityCode
      - contactPhone
      - expirationDate
      - name
    properties:
      INSTALLMENTS_NUMBER:
        type: string
        maxLength: 64
        description: The name of the parameter. Example= "INSTALLMENTS_NUMBER", "RESPONSE_URL", "PSE_REFERENCE1, etc. See use of this variable in the examples by country.

#---------------------------------------------
  person:
    type: object
    required:
      - documentType
    properties:
      documentType:
        type: string
        description: Customer document Type

#---------------------------------------------

  partner:
    type: object
    required:
      - partner
      - securityCode
    properties:
      partnerId:
        type: string
        description: Partner Id

#---------------------------------------------

  event:
    type: object
    required:
      - eventType
      - channel
      - statusEvent
    properties:
      eventType:
        type: string
        maxLength: 2
        enum:
            - "01"
        description: Event type, 01=Emission
      channel:
        type: number
        maxLength: 2
        enum:
            - 3
        description: Channel used to add or update the record. 03=Ventas Digitales.
      eventStatus:
        type: string
        maxLength: 2
        enum:
             - BG
        description: BG=Begin, CL=Closed, CN=Cancel, SC=Successfully completed or finished,
                     PN=Pending, PR=In Process, FL=Failed .
      userId:
        type: string
        maxLength: 30
        description: User who registered the event.

#---------------------------------------------

  paymentGatewayResponseToken:
    type: object
    properties:
      returnCode:
        type: integer
        description: Response Return Code
      mesagge:
        type: string
        description: Response Description
      bodyRespponse:
          $ref: "#/definitions/payuResponse"

#---------------------------------------------
  payuResponse:
    type: object
    properties:
      code:
        type: string
        description: Codigo respuesta Pauy
      error:
        type: string
        description: error respuesta Payu
      transactionResponse:
        type: object
        properties:
          orderId:
            type: integer
            description: Numero de orden Payu
          transactionId:
            type: string
            description: Id de transaccion Payu
          state:
            type: string
            description: Estado Payu
          paymentNetworkResponseCode:
            type: string
            description: Codigo de respuesta Payu
          paymentNetworkResponseErrorMessage:
            type: string
            description: Mensaje codigo de respuesta nPayu
          trazabilityCode:
            type: string
            description: trazabilidad Payu
          authorizationCode:
            type: string
            description: codigo de autorizacion Payu
          pendingReason:
            type: string
            description: Razon pendiente Payu
          responseCode:
            type: string
            description: codigo respuesta Payu
          errorCode:
            type: string
            description: codigo de error
          responseMessage:
            type: string
            description: Mensaje de respuesta Payu
          transactionDate:
            type: string
            description: fecha Payu
          transactionTime:
            type: string
            description: Hora Payu
          operationDate:
            type: string
            description: Fecha operacion Payu
          extraParameters:
            type: string
            description: Parametros extra Payu

